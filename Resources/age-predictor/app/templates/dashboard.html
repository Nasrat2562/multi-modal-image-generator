<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Conversion Hub | Professional Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@800;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary: #7c3aed; --primary-light: #8b5cf6; --secondary: #06b6d4;
            --ghibli-green: #22c55e; --monet-blue: #3b82f6; --toon-pink: #ec4899;
            --prompt-purple: #a855f7; --sdxl-cyan: #06b6d4; --dark: #0f172a;
            --dark-light: #1e293b; --light: #f8fafc; --gray: #94a3b8;
            --success: #10b981; --warning: #f59e0b; --error: #ef4444;
            --gradient-primary: linear-gradient(135deg, #7c3aed 0%, #06b6d4 100%);
            --gradient-ghibli: linear-gradient(135deg, #22c55e 0%, #0ea5e9 100%);
            --gradient-monet: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            --gradient-toon: linear-gradient(135deg, #ec4899 0%, #f97316 100%);
            --gradient-prompt: linear-gradient(135deg, #a855f7 0%, #f59e0b 100%);
            --gradient-sdxl: linear-gradient(135deg, #8B5CF6 0%, #06B6D4 100%);
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-hover: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --radius: 16px; --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 1rem 2rem;
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 900;
            font-size: 1.8rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .logo-icon { font-size: 2.2rem; }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 16px;
            border-radius: 50px;
            transition: var(--transition);
        }
        
        .user-profile:hover { background: rgba(255, 255, 255, 0.1); }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
        }
        
        .user-details { display: flex; flex-direction: column; }
        .user-name { font-weight: 600; font-size: 0.95rem; }
        .user-status { font-size: 0.8rem; color: var(--gray); display: flex; align-items: center; gap: 5px; }
        .status-indicator { width: 8px; height: 8px; background-color: var(--success); border-radius: 50%; }
        
        .logout-btn {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            transform: translateY(-2px);
        }
        
        /* Main Content */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Welcome Section */
        .welcome-section {
            background: var(--gradient-primary);
            border-radius: var(--radius);
            padding: 3rem;
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
        }
        
        .welcome-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
        }
        
        .welcome-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 1rem;
            line-height: 1.1;
        }
        
        .welcome-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 2rem;
            max-width: 600px;
        }
        
        .stats-container {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 12px;
            min-width: 180px;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Dashboard Grid */
        .dashboard-title {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .dashboard-title i {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        /* Tool Cards */
        .tool-card {
            background: var(--dark-light);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            height: 100%;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .tool-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-hover);
        }
        
        .tool-header {
            padding: 2rem 2rem 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .tool-icon {
            width: 70px;
            height: 70px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: white;
        }
        
        .tool-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .tool-subtitle {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        .tool-body {
            padding: 0 2rem 1.5rem;
            flex-grow: 1;
        }
        
        .tool-description {
            color: var(--gray);
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }
        
        .tool-features {
            list-style: none;
            margin-bottom: 1.5rem;
        }
        
        .tool-features li {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .tool-features i { color: var(--success); }
        
        .tool-footer {
            padding: 1.5rem 2rem;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .tool-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: white;
        }
        
        .info-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .info-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* Tool specific colors */
        .tool-card.ghibli .tool-header { background: var(--gradient-ghibli); }
        .tool-card.ghibli .tool-btn:not(.info-btn) { background: var(--ghibli-green); }
        .tool-card.ghibli .tool-btn:not(.info-btn):hover { background: #16a34a; transform: translateY(-3px); }
        
        .tool-card.monet .tool-header { background: var(--gradient-monet); }
        .tool-card.monet .tool-btn:not(.info-btn) { background: var(--monet-blue); }
        .tool-card.monet .tool-btn:not(.info-btn):hover { background: #2563eb; transform: translateY(-3px); }
        
        .tool-card.toon .tool-header { background: var(--gradient-toon); }
        .tool-card.toon .tool-btn:not(.info-btn) { background: var(--toon-pink); }
        .tool-card.toon .tool-btn:not(.info-btn):hover { background: #db2777; transform: translateY(-3px); }
        
        .tool-card.prompt .tool-header { background: var(--gradient-prompt); }
        .tool-card.prompt .tool-btn:not(.info-btn) { background: var(--prompt-purple); }
        .tool-card.prompt .tool-btn:not(.info-btn):hover { background: #9333ea; transform: translateY(-3px); }
        
        .tool-card.sdxl .tool-header { background: var(--gradient-sdxl); }
        .tool-card.sdxl .tool-btn:not(.info-btn) { background: var(--sdxl-cyan); }
        .tool-card.sdxl .tool-btn:not(.info-btn):hover { background: #0891b2; transform: translateY(-3px); }
        
        /* Recent Activity */
        .activity-section {
            background: var(--dark-light);
            border-radius: var(--radius);
            padding: 2rem;
            margin-bottom: 3rem;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            transition: var(--transition);
        }
        
        .activity-item:hover {
            background: rgba(255, 255, 255, 0.06);
        }
        
        .activity-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: white;
        }
        
        .activity-details { flex-grow: 1; }
        .activity-title { font-weight: 600; margin-bottom: 4px; }
        .activity-time { font-size: 0.85rem; color: var(--gray); }
        
        .activity-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-completed { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .status-processing { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .status-failed { background: rgba(239, 68, 68, 0.2); color: var(--error); }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: var(--gray);
            font-size: 0.9rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Launch Modal */
        .launch-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: var(--dark-light);
            border-radius: var(--radius);
            padding: 2.5rem;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 2rem;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .close-modal:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }
        
        /* Tool Info Modal */
        .tool-info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .tool-info-content {
            background: var(--dark-light);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-hover);
            animation: modalSlideIn 0.3s ease;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .tools-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
        }
        
        @media (max-width: 768px) {
            .header { padding: 1rem; }
            .main-container { padding: 1rem; }
            .welcome-section { padding: 2rem 1.5rem; }
            .welcome-title { font-size: 2.2rem; }
            .stats-container { flex-direction: column; gap: 1rem; }
            .tools-grid { grid-template-columns: 1fr; }
            .user-details { display: none; }
            .modal-content { padding: 1.5rem; }
            .tool-info-content { padding: 1.5rem; }
        }
        
        @media (max-width: 480px) {
            .logo span { display: none; }
            .welcome-title { font-size: 1.8rem; }
            .modal-content { padding: 1rem; }
            .tool-info-content { padding: 1rem; }
        }
    </style>
</head>
<body>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('üìä Dashboard loading...');
    
    // Check authentication
    async function checkAuth() {
        try {
            // First, check server session
            const response = await fetch('/check-auth');
            const authData = await response.json();
            console.log('üîç Server auth check:', authData);
            
            if (authData.authenticated) {
                console.log('‚úÖ Server authentication successful');
                return true;
            }
            
            // Fallback: check localStorage
            const userName = localStorage.getItem('aiDashboardUser');
            const isVerified = localStorage.getItem('aiDashboardVerified');
            
            console.log('üì¶ localStorage check:', { userName, isVerified });
            
            if (userName && isVerified === 'true') {
                console.log('‚úÖ localStorage authentication successful');
                return true;
            }
            
            return false;
            
        } catch (error) {
            console.error('‚ùå Auth check error:', error);
            return false;
        }
    }
    
    // Perform authentication check
    checkAuth().then(isAuthenticated => {
        if (!isAuthenticated) {
            console.log('‚ùå User not authenticated, redirecting to login...');
            alert('Please login or sign up first');
            window.location.href = '/';
            return;
        }
        
        console.log('‚úÖ User authenticated, initializing dashboard...');
        // Initialize dashboard
        initDashboard();
    });
});
</script>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-magic logo-icon"></i>
                <span>AI CONVERSION HUB</span>
            </div>
            
            <div class="user-info">
                <div class="user-profile">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">User</div>
                        <div class="user-status">
                            <span class="status-indicator"></span>
                            <span>Age Verified</span>
                        </div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logoutUser()">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Welcome Section -->
        <section class="welcome-section">
            <div class="welcome-content">
                <h1 class="welcome-title">Transform Your Images with AI Magic</h1>
                <p class="welcome-subtitle">Welcome back! Based on your age verification, you have full access to our premium AI conversion tools. Select a tool below to start creating.</p>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="conversionCount">0</div>
                        <div class="stat-label">Conversions Today</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="toolCount">5</div>
                        <div class="stat-label">AI Tools Available</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="processingTime">2s</div>
                        <div class="stat-label">Avg. Processing Time</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tools Dashboard -->
        <section class="tools-section">
            <h2 class="dashboard-title">
                <i class="fas fa-wand-magic-sparkles"></i>
                AI Conversion Tools
            </h2>
            
            <div class="tools-grid">
                <!-- Ghibli Style Converter -->
                <div class="tool-card ghibli">
                    <div class="tool-header">
                        <div class="tool-icon">
                            <i class="fas fa-paintbrush"></i>
                        </div>
                        <h3 class="tool-title">Image to Ghibli</h3>
                        <p class="tool-subtitle">Studio Ghibli art style</p>
                    </div>
                    <div class="tool-body">
                        <p class="tool-description">Transform your photos into beautiful Studio Ghibli-style artwork. Perfect for creating dreamy, animated scenes.</p>
                        <ul class="tool-features">
                            <li><i class="fas fa-check-circle"></i> Anime-style transformation</li>
                            <li><i class="fas fa-check-circle"></i> Preserves image details</li>
                            <li><i class="fas fa-check-circle"></i> Multiple Ghibli styles</li>
                            <li><i class="fas fa-check-circle"></i> Camera support</li>
                        </ul>
                    </div>
                    <div class="tool-footer">
                        <button class="tool-btn" onclick="launchTool('ghibli')">
                            <i class="fas fa-external-link-alt"></i>
                            Go to Ghibli Tool
                        </button>
                        <button class="tool-btn info-btn" onclick="showToolInfo('ghibli')">
                            <i class="fas fa-info-circle"></i>
                            View Details
                        </button>
                    </div>
                </div>

                <!-- Monet Style Converter -->
                <div class="tool-card monet">
                    <div class="tool-header">
                        <div class="tool-icon">
                            <i class="fas fa-water"></i>
                        </div>
                        <h3 class="tool-title">Image to Monet</h3>
                        <p class="tool-subtitle">Impressionist art style</p>
                    </div>
                    <div class="tool-body">
                        <p class="tool-description">Apply Claude Monet's impressionist painting style to your images. Create beautiful, brushstroke-rich artwork.</p>
                        <ul class="tool-features">
                            <li><i class="fas fa-check-circle"></i> Oil painting effect</li>
                            <li><i class="fas fa-check-circle"></i> Color palette matching</li>
                            <li><i class="fas fa-check-circle"></i> Brushstroke simulation</li>
                        </ul>
                    </div>
                    <div class="tool-footer">
                        <button class="tool-btn" onclick="launchTool('monet')">
                            <i class="fas fa-external-link-alt"></i>
                            Go to Monet Tool
                        </button>
                        <button class="tool-btn info-btn" onclick="showToolInfo('monet')">
                            <i class="fas fa-info-circle"></i>
                            View Details
                        </button>
                    </div>
                </div>

                <!-- Toon Style Converter -->
                <div class="tool-card toon">
                    <div class="tool-header">
                        <div class="tool-icon">
                            <i class="fas fa-smile"></i>
                        </div>
                        <h3 class="tool-title">Image to Toon</h3>
                        <p class="tool-subtitle">Cartoon & animation style</p>
                    </div>
                    <div class="tool-body">
                        <p class="tool-description">Turn your photos into cartoon characters or animated scenes. Perfect for creating avatars or fun illustrations.</p>
                        <ul class="tool-features">
                            <li><i class="fas fa-check-circle"></i> Multiple cartoon styles</li>
                            <li><i class="fas fa-check-circle"></i> Line art enhancement</li>
                            <li><i class="fas fa-check-circle"></i> Color simplification</li>
                        </ul>
                    </div>
                    <div class="tool-footer">
                        <button class="tool-btn" onclick="launchTool('toon')">
                            <i class="fas fa-external-link-alt"></i>
                            Go to Toon Tool
                        </button>
                        <button class="tool-btn info-btn" onclick="showToolInfo('toon')">
                            <i class="fas fa-info-circle"></i>
                            View Details
                        </button>
                    </div>
                </div>

                <!-- Prompt to Image -->
                <div class="tool-card prompt">
                    <div class="tool-header">
                        <div class="tool-icon">
                            <i class="fas fa-font"></i>
                        </div>
                        <h3 class="tool-title">Prompt to Image</h3>
                        <p class="tool-subtitle">Text-to-image generation</p>
                    </div>
                    <div class="tool-body">
                        <p class="tool-description">Generate unique images from text descriptions. Our AI will bring your imagination to life with stunning visuals.</p>
                        <ul class="tool-features">
                            <li><i class="fas fa-check-circle"></i> Advanced AI models</li>
                            <li><i class="fas fa-check-circle"></i> Multiple art styles</li>
                            <li><i class="fas fa-check-circle"></i> High-resolution output</li>
                        </ul>
                    </div>
                    <div class="tool-footer">
                        <button class="tool-btn" onclick="launchTool('prompt')">
                            <i class="fas fa-external-link-alt"></i>
                            Go to Prompt Tool
                        </button>
                        <button class="tool-btn info-btn" onclick="showToolInfo('prompt')">
                            <i class="fas fa-info-circle"></i>
                            View Details
                        </button>
                    </div>
                </div>

                <!-- SDXL Image Generator -->
                <div class="tool-card sdxl">
                    <div class="tool-header">
                        <div class="tool-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3 class="tool-title">SDXL Image Generator</h3>
                        <p class="tool-subtitle">Advanced AI image generation</p>
                    </div>
                    <div class="tool-body">
                        <p class="tool-description">Generate high-quality images using Stable Diffusion XL model with text prompts and image guidance.</p>
                        <ul class="tool-features">
                            <li><i class="fas fa-check-circle"></i> Stable Diffusion XL model</li>
                            <li><i class="fas fa-check-circle"></i> Text-to-image generation</li>
                            <li><i class="fas fa-check-circle"></i> High-resolution outputs</li>
                        </ul>
                    </div>
                    <div class="tool-footer">
                        <button class="tool-btn" onclick="launchTool('sdxl')">
                            <i class="fas fa-external-link-alt"></i>
                            Go to SDXL Tool
                        </button>
                        <button class="tool-btn info-btn" onclick="showToolInfo('sdxl')">
                            <i class="fas fa-info-circle"></i>
                            View Details
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Recent Activity -->
        <section class="activity-section">
            <div class="section-header">
                <h3 class="section-title">Recent Activity</h3>
                <button class="view-all" onclick="clearActivity()" style="background: none; border: none; color: var(--primary-light); cursor: pointer; font-weight: 600;">
                    Clear All
                </button>
            </div>
            
            <div class="activity-list" id="activityList">
                <!-- Activities will be dynamically added here -->
                <div class="activity-item">
                    <div class="activity-icon" style="background: var(--gradient-ghibli);">
                        <i class="fas fa-paintbrush"></i>
                    </div>
                    <div class="activity-details">
                        <div class="activity-title">Welcome to AI Conversion Hub!</div>
                        <div class="activity-time">Just now</div>
                    </div>
                    <div class="activity-status status-completed">Ready</div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>AI Conversion Dashboard &copy; 2024 | All conversions are processed securely</p>
    </footer>

    <!-- Launch Modal -->
    <div class="launch-modal" id="launchModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalToolTitle">
                    <i class="fab fa-windows" style="color: #0078d4;"></i>
                    Launch Tool
                </h3>
                <button class="close-modal" onclick="closeLaunchModal()">√ó</button>
            </div>
            <div id="modalContent">
                <!-- Dynamic content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Tool Info Modal -->
    <div class="tool-info-modal" id="toolInfoModal">
        <div class="tool-info-content" id="toolInfoContent">
            <!-- Dynamic content will be loaded here -->
        </div>
    </div>

<script>
// Tool configuration - Updated with correct ports
const tools = {
    ghibli: {
        name: "Image to Ghibli",
        path: "../ghibli-webapp/",
        envName: "ghibli_final",
        envExists: true,
        port: 5000,
        description: "Transform photos into Studio Ghibli-style artwork.",
        icon: "fas fa-paintbrush",
        color: "var(--gradient-ghibli)",
        url: "http://localhost:5000",
        launchCommand: "call ghibli_final\\Scripts\\activate && python app.py"
    },
    // AI Art Transformer (Combined Monet & Toon)
art_transformer: {
    name: "AI Art Transformer",
    path: "../style-transfer-app/",
    envName: "ai_env",
    envExists: true,
    port: 5004,
    description: "Transform photos into Monet paintings OR cartoon characters using Lykon/dreamshaper-8 AI (Image-to-Image).",
    icon: "fas fa-palette",
    color: "var(--gradient-monet)",
    url: "http://localhost:5004",
    launchCommand: "call ai_env\\Scripts\\activate && cd app && python main_final.py",
    monetUrl: "http://localhost:5004/monet",
    toonUrl: "http://localhost:5004/toon"
},
// Individual Monet (for backward compatibility)
monet: {
    name: "Image to Monet",
    path: "../style-transfer-app/",
    envName: "ai_env",
    envExists: true,
    port: 5004,
    description: "Apply Monet's impressionist painting style using Stable Diffusion Image-to-Image AI.",
    icon: "fas fa-water",
    color: "var(--gradient-monet)",
    url: "http://localhost:5004/monet",
    launchCommand: "call ai_env\\Scripts\\activate && cd app && python main_final.py"
},
// Individual Toon (for backward compatibility)
toon: {
    name: "Image to Toon",
    path: "../style-transfer-app/",
    envName: "ai_env",
    envExists: true,
    port: 5004,
    description: "Turn photos into cartoon characters using AI image-to-image style transfer.",
    icon: "fas fa-smile",
    color: "var(--gradient-toon)",
    url: "http://localhost:5004/toon",
    launchCommand: "call ai_env\\Scripts\\activate && cd app && python main_final.py"
},
    // AI Image Generator (using embedded Python)
    prompt: {
        name: "AI Image Generator",
        path: "../ai-image-generator/",
        envName: "",  // No virtual environment
        envExists: false,
        port: 5001,
        description: "Generate images from text descriptions using Stable Diffusion 1.5.",
        icon: "fas fa-font",
        color: "var(--gradient-prompt)",
        url: "http://localhost:5001",
        launchCommand: "\"C:\\Users\\USER\\python-3.11.9-embed-amd64\\python.exe\" app.py",
        features: [
            "Real Stable Diffusion 1.5 AI",
            "Text-to-image generation",
            "Multiple art styles",
            "Download button for images",
            "Organized output folder"
        ],
        outputFolder: "output/generated_images/"
    },
    // SDXL Generator - CORRECTED PORT from 5002 to 5003
    sdxl: {
        name: "SDXL Image Generator",
        path: "../image-prompt/",
        envName: "sdxl_env",
        envExists: true,
        port: 5003,  // CHANGED FROM 5002 to 5003
        description: "Generate images using Stable Diffusion XL.",
        icon: "fas fa-robot",
        color: "var(--gradient-sdxl)",
        url: "http://localhost:5003",  // CHANGED FROM 5002 to 5003
        launchCommand: "call sdxl_env\\Scripts\\activate && python app.py"
    },
    // Age Verification
    age_verification: {
        name: "Age Verification",
        path: "../age-predictor/",
        envName: "age_venv",
        envExists: true,
        port: 5005,
        description: "Predict age from facial images using AI.",
        icon: "fas fa-user-check",
        color: "var(--gradient-age)",
        url: "http://localhost:5005",
        launchCommand: "call age_venv\\Scripts\\activate && cd app && python run.py"
    }
};

    // Current user data
    let currentUser = {
        name: localStorage.getItem('aiDashboardUser') || 'User',
        age: localStorage.getItem('aiDashboardAge') || 'N/A',
        conversions: parseInt(localStorage.getItem('conversionCount') || '3')
    };

    // Activity log
    let activityLog = JSON.parse(localStorage.getItem('activityLog') || '[{"title": "Welcome to AI Conversion Hub!", "time": "Just now", "status": "completed", "icon": "fas fa-paintbrush", "color": "var(--gradient-ghibli)"}]');

    // DOM Elements
    const userAvatar = document.getElementById('userAvatar');
    const userName = document.getElementById('userName');
    const conversionCount = document.getElementById('conversionCount');
    const toolCount = document.getElementById('toolCount');
    const processingTime = document.getElementById('processingTime');
    const activityList = document.getElementById('activityList');

    // Initialize the dashboard
    function initDashboard() {
        // Set user info
        if (userName) userName.textContent = currentUser.name;
        if (userAvatar) userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
        
        // Set stats
        if (conversionCount) {
            animateCount(conversionCount, 0, currentUser.conversions, 1500);
        }
        if (toolCount) toolCount.textContent = Object.keys(tools).length;
        
        // Load activity log
        loadActivityLog();
        
        // Start activity updates
        startActivityUpdates();
        
        console.log('Dashboard initialized successfully');
    }

    // Logout function
    function logoutUser() {
        if (confirm('Are you sure you want to logout?')) {
            // Clear all user data from localStorage
            localStorage.removeItem('aiDashboardUser');
            localStorage.removeItem('aiDashboardEmail');
            localStorage.removeItem('aiDashboardAge');
            localStorage.removeItem('aiDashboardVerified');
            localStorage.removeItem('user_id');
            localStorage.removeItem('logged_in');
            localStorage.removeItem('signup_completed');
            localStorage.removeItem('conversionCount');
            localStorage.removeItem('activityLog');
            
            // Clear sessionStorage
            sessionStorage.clear();
            
            // Show notification
            showNotification('üëã Logging out...', 'info');
            
            // Call server logout API if available
            fetch('/api/logout', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                }
            }).catch(() => {
                // Ignore errors, just continue with logout
            });
            
            // Redirect to login page immediately
            setTimeout(() => {
                window.location.href = '/';
            }, 500);
        }
    }

    // Launch Tool function
    function launchTool(toolId) {
        const tool = tools[toolId];
        if (!tool) {
            showNotification('‚ùå Tool not found', 'error');
            return;
        }
        
        // Update conversion count
        updateConversionCount();
        
        // Add to recent activity
        addToRecentActivity(`Launched ${tool.name}`, toolId, 'processing');
        
        // Check if tool is running
        testToolConnection(tool.port, getToolPath(toolId))
            .then(isRunning => {
                if (isRunning) {
                    // Tool is running, open in new tab
                    window.open(tool.url, '_blank', 'noopener,noreferrer');
                    showNotification(`‚úÖ Opening ${tool.name}...`, 'success');
                    updateActivityStatus(toolId, 'completed');
                } else {
                    // Tool not running, show launch modal
                    showLaunchModal(tool);
                    updateActivityStatus(toolId, 'failed');
                }
            })
            .catch(() => {
                // Error checking
                showNotification(`‚ö†Ô∏è Could not connect to ${tool.name}.`, 'warning');
                showLaunchModal(tool);
                updateActivityStatus(toolId, 'failed');
            });
    }

    // Test tool connection
    function testToolConnection(port, path = '/') {
        return new Promise((resolve) => {
            const timeoutId = setTimeout(() => {
                resolve(false);
            }, 2000);
            
            fetch(`http://localhost:${port}${path}`, { 
                method: 'HEAD',
                mode: 'no-cors'
            })
            .then(() => {
                clearTimeout(timeoutId);
                resolve(true);
            })
            .catch(() => {
                clearTimeout(timeoutId);
                resolve(false);
            });
        });
    }

    // Get tool path for connection test
    function getToolPath(toolId) {
        switch(toolId) {
            case 'monet': return '/monet';
            case 'toon': return '/toon';
            default: return '/';
        }
    }

    // Show launch modal
    function showLaunchModal(tool) {
        const toolId = Object.keys(tools).find(key => tools[key] === tool);
        const isWindows = navigator.platform.includes('Win');
        const toolHasEnv = tool.envExists && tool.envName;
        
        // Build Windows command
        let windowsCommand;
        if (toolId === 'monet' || toolId === 'toon') {
            // Monet/Toon specific command
            if (toolHasEnv) {
                windowsCommand = `cd ${tool.path}\r\n${tool.envName}\\Scripts\\activate\r\n${tool.launchCommand}`;
            } else {
                windowsCommand = `cd ${tool.path}\r\n${tool.launchCommand}`;
            }
        } else {
            // Other tools
            if (toolHasEnv) {
                windowsCommand = `cd ${tool.path}\r\n${tool.envName}\\Scripts\\activate\r\npython app.py`;
            } else {
                windowsCommand = `cd ${tool.path}\r\npython app.py`;
            }
        }
        
        // Determine access URL
        let accessUrl = tool.url;
        
        const envInfo = toolHasEnv 
            ? `<div style="color: var(--success); margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                  <i class="fas fa-check-circle"></i> Virtual environment: <strong>${tool.envName}</strong>
               </div>`
            : `<div style="color: var(--warning); margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                  <i class="fas fa-exclamation-triangle"></i> Uses system Python
               </div>`;
        
        const modalContent = `
            <div style="margin-bottom: 25px;">
                <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="color: var(--light); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-info-circle" style="color: var(--primary-light);"></i>
                        Launch ${tool.name}
                    </h3>
                    <p style="color: var(--gray); line-height: 1.7; margin-bottom: 15px;">
                        ${tool.description}
                    </p>
                    ${envInfo}
                    <div style="display: flex; gap: 20px; margin-top: 15px;">
                        <div style="flex: 1;">
                            <div style="color: var(--gray); font-size: 14px; margin-bottom: 5px;">Access URL:</div>
                            <div style="color: #3b82f6; font-weight: 600; font-size: 16px;">
                                ${accessUrl}
                            </div>
                        </div>
                        <div style="flex: 1;">
                            <div style="color: var(--gray); font-size: 14px; margin-bottom: 5px;">Status:</div>
                            <div style="color: var(--warning); font-weight: 600; font-size: 16px;" id="toolStatus">
                                Not running
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="background: #0a0a0a; padding: 25px; border-radius: 12px; margin-bottom: 20px; border: 2px solid #333;">
                    <h3 style="color: #00ff00; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; font-family: 'Consolas', monospace;">
                        <i class="fas fa-terminal"></i>
                        Windows Command Prompt
                    </h3>
                    
                    <div style="background: #000; color: #00ff00; padding: 20px; border-radius: 8px; font-family: 'Consolas', monospace; font-size: 16px; line-height: 1.8; white-space: pre; overflow-x: auto; border: 1px solid #00ff00; min-height: 120px;" id="commandDisplay">
${windowsCommand}
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap;">
                        <button onclick="copyToClipboard('${windowsCommand.replace(/\r\n/g, '\\r\\n')}')" style="
                            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); 
                            color: white; border: none;
                            padding: 12px 25px; border-radius: 10px; cursor: pointer;
                            display: flex; align-items: center; gap: 10px; font-weight: 600;
                            font-size: 16px; transition: transform 0.3s, box-shadow 0.3s;"
                            onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 10px 20px rgba(124, 58, 237, 0.3)'"
                            onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
                            <i class="fas fa-copy"></i> Copy Commands
                        </button>
                        
                        <button onclick="testConnection(${tool.port}, '${getToolPath(toolId)}')" style="
                            background: linear-gradient(135deg, var(--success) 0%, #0ea5e9 100%); 
                            color: white; border: none;
                            padding: 12px 25px; border-radius: 10px; cursor: pointer;
                            display: flex; align-items: center; gap: 10px; font-weight: 600;
                            font-size: 16px; transition: transform 0.3s, box-shadow 0.3s;"
                            onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 10px 20px rgba(16, 185, 129, 0.3)'"
                            onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                        
                        <button onclick="openToolDirect('${toolId}')" style="
                            background: linear-gradient(135deg, var(--secondary) 0%, #0ea5e9 100%); 
                            color: white; border: none;
                            padding: 12px 25px; border-radius: 10px; cursor: pointer;
                            display: flex; align-items: center; gap: 10px; font-weight: 600;
                            font-size: 16px; transition: transform 0.3s, box-shadow 0.3s;"
                            onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 10px 20px rgba(6, 182, 212, 0.3)'"
                            onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='none'">
                            <i class="fas fa-external-link-alt"></i> Open Directly
                        </button>
                    </div>
                </div>
                
                <div style="background: rgba(59, 130, 246, 0.15); padding: 20px; border-radius: 12px; margin-bottom: 20px; border-left: 4px solid #3b82f6;">
                    <h4 style="color: #3b82f6; margin-bottom: 12px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-lightbulb"></i> Instructions
                    </h4>
                    <ol style="color: var(--gray); margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li>Open <strong>Command Prompt</strong></li>
                        <li><strong>Copy and paste</strong> the commands above</li>
                        ${toolHasEnv 
                            ? `<li>Wait for <code>(${tool.envName})</code> to appear in prompt</li>`
                            : '<li>No environment activation needed</li>'
                        }
                        <li>Tool will start and show a URL</li>
                        <li>Open: <code style="background: rgba(0,0,0,0.3); padding: 2px 8px; border-radius: 4px;">${accessUrl}</code></li>
                    </ol>
                </div>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: space-between; align-items: center; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <div style="color: var(--gray); font-size: 14px; display: flex; align-items: center; gap: 8px;">
                    <i class="fab fa-windows" style="color: #0078d4;"></i>
                    Windows Command Prompt
                </div>
                <button onclick="closeLaunchModal()" style="
                    background: var(--secondary); color: white; border: none;
                    padding: 14px 35px; border-radius: 10px; cursor: pointer;
                    font-weight: 700; font-size: 17px; letter-spacing: 0.5px;
                    transition: all 0.3s;"
                    onmouseover="this.style.background='#0ea5e9';this.style.transform='translateY(-2px)'"
                    onmouseout="this.style.background='var(--secondary)';this.style.transform='translateY(0)'">
                    üëç Got It!
                </button>
            </div>`;
        
        // Update modal content
        document.getElementById('modalToolTitle').innerHTML = `<i class="fab fa-windows" style="color: #0078d4;"></i> Launch ${tool.name}`;
        document.getElementById('modalContent').innerHTML = modalContent;
        
        // Show modal
        document.getElementById('launchModal').style.display = 'flex';
        
        // Test connection immediately
        setTimeout(() => testConnection(tool.port, getToolPath(toolId)), 500);
    }

    // Show tool information
    function showToolInfo(toolId) {
        const tool = tools[toolId];
        if (!tool) return;
        
        const toolColor = getToolColor(toolId);
        
        const modalContent = `
            <div style="padding: 20px;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="width: 80px; height: 80px; border-radius: 16px; background: ${tool.color}; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px;">
                        <i class="${tool.icon}" style="font-size: 2rem; color: white;"></i>
                    </div>
                    <h3 style="color: var(--light); margin-bottom: 5px;">${tool.name}</h3>
                    <p style="color: var(--gray);">${tool.description}</p>
                </div>
                
                <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                    <h4 style="color: var(--light); margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-cogs"></i> Technical Details
                    </h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <span style="color: var(--gray); font-size: 14px;">Port:</span>
                            <div style="color: var(--light); font-weight: 600;">${tool.port}</div>
                        </div>
                        <div>
                            <span style="color: var(--gray); font-size: 14px;">Environment:</span>
                            <div style="color: ${tool.envExists ? 'var(--success)' : 'var(--warning)'}; font-weight: 600;">
                                ${tool.envName || 'None'}
                            </div>
                        </div>
                        <div>
                            <span style="color: var(--gray); font-size: 14px;">Path:</span>
                            <div style="color: var(--light); font-weight: 600; font-size: 12px;">${tool.path}</div>
                        </div>
                        <div>
                            <span style="color: var(--gray); font-size: 14px;">Status:</span>
                            <div style="color: var(--warning); font-weight: 600;" id="statusCheck">Checking...</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: rgba(59, 130, 246, 0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px; border-left: 3px solid #3b82f6;">
                    <h4 style="color: var(--light); margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-rocket"></i> Quick Access
                    </h4>
                    <div style="color: var(--gray); margin-bottom: 15px;">
                        <div style="margin-bottom: 8px;">Access URL:</div>
                        <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 6px; font-family: monospace; color: #3b82f6;">
                            ${tool.url}
                        </div>
                    </div>
                    <button onclick="launchTool('${toolId}')" style="
                        width: 100%;
                        background: ${toolColor};
                        color: white; border: none;
                        padding: 12px; border-radius: 10px; cursor: pointer;
                        font-weight: 600; font-size: 16px; display: flex; align-items: center;
                        justify-content: center; gap: 10px; margin-top: 10px;">
                        <i class="fas fa-external-link-alt"></i>
                        Open ${tool.name}
                    </button>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="closeToolInfo()" style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); color: var(--light); border: none; border-radius: 8px; cursor: pointer;">
                        Close
                    </button>
                    <button onclick="launchTool('${toolId}')" style="flex: 1; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                        Launch Tool
                    </button>
                </div>
            </div>`;
        
        // Update modal content
        document.getElementById('toolInfoContent').innerHTML = modalContent;
        
        // Show modal
        document.getElementById('toolInfoModal').style.display = 'flex';
        
        // Check tool status
        testToolConnection(tool.port, getToolPath(toolId))
            .then(isRunning => {
                const statusElement = document.getElementById('statusCheck');
                if (statusElement) {
                    statusElement.textContent = isRunning ? 'Running ‚úì' : 'Not running';
                    statusElement.style.color = isRunning ? 'var(--success)' : 'var(--warning)';
                }
            });
    }

    // Get tool color
    function getToolColor(toolId) {
        switch(toolId) {
            case 'ghibli': return 'linear-gradient(135deg, #22c55e 0%, #0ea5e9 100%)';
            case 'monet': return 'linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)';
            case 'toon': return 'linear-gradient(135deg, #ec4899 0%, #f97316 100%)';
            case 'prompt': return 'linear-gradient(135deg, #a855f7 0%, #f59e0b 100%)';
            case 'sdxl': return 'linear-gradient(135deg, #8B5CF6 0%, #06B6D4 100%)';
            default: return 'var(--primary)';
        }
    }

    // Close tool info modal
    function closeToolInfo() {
        document.getElementById('toolInfoModal').style.display = 'none';
    }

    // Test connection from modal
    function testConnection(port, path = '/') {
        const statusElement = document.getElementById('toolStatus');
        if (statusElement) {
            statusElement.textContent = 'Testing...';
            statusElement.style.color = 'var(--warning)';
        }
        
        testToolConnection(port, path)
            .then(isRunning => {
                if (statusElement) {
                    statusElement.textContent = isRunning ? 'Running ‚úì' : 'Not running';
                    statusElement.style.color = isRunning ? 'var(--success)' : 'var(--warning)';
                }
                if (isRunning) {
                    showNotification(`‚úÖ Tool is running on port ${port}!`, 'success');
                }
            });
    }

    // Open tool directly
    function openToolDirect(toolId) {
        const tool = tools[toolId];
        if (!tool) return;
        
        window.open(tool.url, '_blank', 'noopener,noreferrer');
        showNotification(`üåê Opening ${tool.name} directly...`, 'info');
        closeLaunchModal();
        addToRecentActivity(`Opened ${tool.name} directly`, toolId, 'completed');
    }

    // Close launch modal
    function closeLaunchModal() {
        document.getElementById('launchModal').style.display = 'none';
    }

    // Copy to clipboard
    function copyToClipboard(command) {
        const decodedCommand = command.replace(/\\r\\n/g, '\r\n');
        navigator.clipboard.writeText(decodedCommand)
            .then(() => {
                showNotification('üìã Commands copied to clipboard!', 'success');
            })
            .catch(() => {
                showNotification('‚ùå Could not copy. Please copy manually.', 'error');
            });
    }

    // Update conversion count
    function updateConversionCount() {
        currentUser.conversions++;
        localStorage.setItem('conversionCount', currentUser.conversions.toString());
        
        if (conversionCount) {
            animateCount(conversionCount, currentUser.conversions - 1, currentUser.conversions, 500);
        }
    }

    // Load activity log
    function loadActivityLog() {
        if (!activityList) return;
        
        activityList.innerHTML = '';
        
        activityLog.forEach(activity => {
            const activityItem = createActivityItem(activity);
            activityList.appendChild(activityItem);
        });
    }

    // Create activity item
    function createActivityItem(activity) {
        const div = document.createElement('div');
        div.className = 'activity-item';
        
        div.innerHTML = `
            <div class="activity-icon" style="background: ${activity.color};">
                <i class="${activity.icon}"></i>
            </div>
            <div class="activity-details">
                <div class="activity-title">${activity.title}</div>
                <div class="activity-time">${activity.time}</div>
            </div>
            <div class="activity-status status-${activity.status}">
                ${activity.status === 'completed' ? 'Completed' : 
                  activity.status === 'processing' ? 'Processing' : 'Failed'}
            </div>
        `;
        
        return div;
    }

    // Add to recent activity
    function addToRecentActivity(title, toolId, status) {
        const tool = tools[toolId];
        const now = new Date();
        const time = formatTime(now);
        
        const activity = {
            title: title,
            time: time,
            status: status,
            icon: tool.icon,
            color: tool.color
        };
        
        activityLog.unshift(activity);
        
        // Keep only last 10 activities
        if (activityLog.length > 10) {
            activityLog.pop();
        }
        
        // Save to localStorage
        localStorage.setItem('activityLog', JSON.stringify(activityLog));
        
        // Update UI
        if (activityList) {
            const activityItem = createActivityItem(activity);
            activityList.insertBefore(activityItem, activityList.firstChild);
            
            // Remove oldest if more than 5
            if (activityList.children.length > 5) {
                activityList.removeChild(activityList.lastChild);
            }
        }
    }

    // Update activity status
    function updateActivityStatus(toolId, status) {
        if (activityList && activityList.firstChild) {
            const statusElement = activityList.firstChild.querySelector('.activity-status');
            if (statusElement) {
                statusElement.className = `activity-status status-${status}`;
                statusElement.textContent = status === 'completed' ? 'Completed' : 
                                          status === 'processing' ? 'Processing' : 'Failed';
            }
        }
    }

    // Format time
    function formatTime(date) {
        const now = new Date();
        const diffMs = now - date;
        const diffMins = Math.floor(diffMs / 60000);
        const diffHours = Math.floor(diffMs / 3600000);
        const diffDays = Math.floor(diffMs / 86400000);
        
        if (diffMins < 1) return 'Just now';
        if (diffMins < 60) return `${diffMins}m ago`;
        if (diffHours < 24) return `${diffHours}h ago`;
        if (diffDays < 7) return `${diffDays}d ago`;
        return date.toLocaleDateString();
    }

    // Clear activity log
    function clearActivity() {
        if (confirm('Are you sure you want to clear all activity?')) {
            activityLog = [{
                title: 'Activity log cleared',
                time: 'Just now',
                status: 'completed',
                icon: 'fas fa-trash',
                color: 'var(--gradient-primary)'
            }];
            
            localStorage.setItem('activityLog', JSON.stringify(activityLog));
            loadActivityLog();
            
            showNotification('üóëÔ∏è Activity log cleared', 'info');
        }
    }

    // Start activity updates
    function startActivityUpdates() {
        // Update processing time randomly
        if (processingTime) {
            setInterval(() => {
                const times = ['1.5s', '2s', '2.5s', '3s', '1.8s', '2.2s'];
                const randomTime = times[Math.floor(Math.random() * times.length)];
                processingTime.textContent = randomTime;
            }, 10000);
        }
    }

    // Animate counter
    function animateCount(element, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            element.textContent = Math.floor(progress * (end - start) + start);
            if (progress < 1) {
                window.requestAnimationFrame(step);
            }
        };
        window.requestAnimationFrame(step);
    }

    // Show notification
    function showNotification(message, type = 'info') {
        // Remove existing notification
        const existingNotification = document.querySelector('.notification');
        if (existingNotification) {
            existingNotification.remove();
        }
        
        // Create notification
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.style.cssText = `
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: ${type === 'error' ? 'var(--error)' : 
                        type === 'success' ? 'var(--success)' : 
                        type === 'warning' ? 'var(--warning)' :
                        'var(--dark-light)'};
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            font-weight: 500;
            border-left: 4px solid ${type === 'error' ? 'var(--error)' : 
                                  type === 'success' ? 'var(--success)' : 
                                  type === 'warning' ? 'var(--warning)' :
                                  'var(--primary)'};
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
        `;
        
        const icon = type === 'error' ? '‚ùå' : 
                    type === 'success' ? '‚úÖ' : 
                    type === 'warning' ? '‚ö†Ô∏è' : 
                    '‚ÑπÔ∏è';
        
        notification.innerHTML = `
            <span style="font-size: 1.2rem;">${icon}</span>
            <span>${message}</span>
        `;
        
        document.body.appendChild(notification);
        
        // Remove after 4 seconds
        setTimeout(() => {
            notification.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }, 4000);
        
        // Add CSS animations if not exists
        if (!document.querySelector('#notification-animations')) {
            const style = document.createElement('style');
            style.id = 'notification-animations';
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', initDashboard);
</script>
</body>
</html>